const e=200,t=400,s=600,n=800,i=1e3,r=async e=>{try{const t=await fetch(e),s=await t.json();if(!t.ok)throw new Error(`Error: ${s.message} (${t.status})`);return s}catch(e){throw e}},a=e=>e[Math.floor(Math.random()*e.length)],o=e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},c=(e,t,s)=>{const n=a(e);for(;t.length!==s;)t.includes(n)?c(e,t,s):t.push(n)},l=e=>null!==e&&""!==e&&e.replace(/(<([^>]+)>)/gi,""),d=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,u=(e,t)=>{let s=e,n=[];if(1===t)return n.push(s),n;for(;0!==s;){let e=d(1,s);n.push(e),s-=e}if(0===s&&n.length>t)return u(e,t);if(0===s&&n.length<t){const e=new Array(t-n.length).fill(0);return[...n,...e]}return n};let h={};class g{static async startTheGame(){_.toggleGameUi(),h=new w;const e=await h.generateQuestion();_.displayQuestion(e)}static endTheGame(){_.toggleGameUi(),_.initUI(),h={}}}class _{static play_btn=document.querySelector(".startingPos__btn");static game_container=document.querySelector(".game");static starting_position=document.querySelector(".startingPos");static answers_text_el=document.querySelectorAll(".answer__text");static question_container=document.querySelector(".question__text");static help_btn_container=document.querySelector(".help__container");static answers_btn_container=document.querySelector(".answer__container");static sidebar_btn=document.querySelector(".sidebar__btn");static prize_list=document.querySelectorAll(".prize__li");static overlay=document.querySelector(".overlay");static modal=document.querySelector(".modal");static modal_close_btn=document.querySelector(".modal__close");static modal_text_container=document.querySelector(".modal__text");static loader=document.querySelector(".loader");static initUI(){this.prize_list.forEach((e=>{e.classList.contains("prize__current")&&e.classList.remove("prize__current")}));[...this.help_btn_container.querySelectorAll("button"),...this.answers_btn_container.querySelectorAll("button")].forEach((e=>{(e.classList.contains("btn--disabled")||e.disabled)&&this.activateBtn(e)})),[this.question_container,...this.answers_text_el].forEach((e=>e.innerText="")),this.sidebar_btn.closest("aside").classList.contains("slide")&&this.toggleSidebar()}static toggleLoader(){this.loader.classList.toggle("hidden")}static toggleSidebar(){const e=this.sidebar_btn,t=e.closest("aside");e.children[0].classList.toggle("rotate"),t.classList.toggle("slide")}static closeModal(){this.modal.classList.add("hidden"),this.overlay.classList.add("hidden"),this.modal_text_container.innerHTML=""}static openModal(e=[]){e.forEach((e=>{const t=document.createElement("p"),s=document.createTextNode(l(e));t.appendChild(s),this.modal_text_container.insertAdjacentElement("beforeend",t)})),this.modal.classList.remove("hidden"),this.overlay.classList.remove("hidden")}static selectPrize(){const e=15-h.currentQuestion,t=e+1;this.prize_list[t]&&this.prize_list[t].classList.remove("prize__current"),this.prize_list[e].classList.add("prize__current")}static disableBtn(e){e.disabled=!0,e.classList.add("btn--disabled")}static activateBtn(e){e.disabled=!1,e.classList.remove("btn--disabled")}static toggleGameUi(){this.starting_position.classList.toggle("hidden"),this.game_container.classList.toggle("hidden"),this.sidebar_btn.closest("aside").classList.toggle("hidden")}static displayQuestion(e){this.question_container.innerText=e;const t=o(h.getAllAnswers());this.answers_text_el.forEach(((e,s)=>{e.innerText=l(t[s])}))}static hideTwoWrongAnswers(e){this.answers_text_el.forEach((t=>{e.includes(t.innerText)&&this.disableBtn(t.parentElement)}))}static displayAudienceHelp(e){const[t,...s]=e,n=h.getAllAnswers().filter((e=>e!==h.currentQuestionCorrectAnswer)),i=`${t}% of audience voted for '${h.currentQuestionCorrectAnswer}'`,r=s.map(((e,t)=>`${e}% of audience voted for '${n[t]}'`)),a=o([i,...r]);this.openModal(a)}}class w{currentQuestionCorrectAnswer="";allRandomWrongAnswers=[];NUM_OF_WRONG_ANSWERS=3;difficulty=e;currentQuestion=0;isHelpCallUsed=!1;isHelpAudienceUsed=!1;isHelpFiftyUsed=!1;questionsAskedId=[];getRandomUnqiueWrongAnswers(e,t,s,n){const i=a(e);for(;t.length!==s;)t.includes(i)||i.answer===n?this.getRandomUnqiueWrongAnswers(e,t,s,n):t.push(i)}async getSameCategoryRandomAnswers(e,t){try{let s=[];const n=await r(`https://jservice.io//api/clues?category=${e}`);if(0===n.length)throw new Error("Failed to upload answers!");this.getRandomUnqiueWrongAnswers(n,s,this.NUM_OF_WRONG_ANSWERS,t);return s.map((e=>e.answer))}catch(e){throw e}}async getNewQuestion(){try{const e=await r(`https://jservice.io//api/clues?value=${this.difficulty}`);if(0===e.length)throw new Error("Failed to upload new question!");const t=a(e),{id:s,category_id:n,question:i,answer:o}=t;if(this.questionsAskedId.includes(s))return this.getNewQuestion();this.questionsAskedId.push(s);const c=await this.getSameCategoryRandomAnswers(n,o),d=l(o),u=c.map((e=>l(e)));return this.currentQuestionCorrectAnswer=d,this.allRandomWrongAnswers=u,i}catch(e){throw e}}async generateQuestion(){_.toggleLoader();try{this.currentQuestion++,this.difficulty=this.setNewDifficulty(15,this.currentQuestion,this.difficulty);return await this.getNewQuestion()}catch(e){_.openModal(["Something went wrong!",e.message])}finally{_.toggleLoader()}}async checkAnswer(e){if(e!==this.currentQuestionCorrectAnswer)return _.openModal(["Wrong answer. You've lost the game!"]),void g.endTheGame();if(this.currentQuestion<15){_.selectPrize();const e=await this.generateQuestion();return _.answers_btn_container.querySelectorAll("button").forEach((e=>{e.classList.contains("btn--disabled")&&_.activateBtn(e)})),void _.displayQuestion(e)}return 15===this.currentQuestion?(_.selectPrize(),_.openModal(["You've won a million dollars!"]),void g.endTheGame()):void 0}removeTwoWrongAnswers(){if(this.isHelpFiftyUsed)return;const e=[];c(this.allRandomWrongAnswers,e,2);const t=this.allRandomWrongAnswers.filter((t=>e.every((e=>t!==e))));return this.allRandomWrongAnswers=t,this.isHelpFiftyUsed=!0,e}getAllAnswers(){const e=this.allRandomWrongAnswers;return[this.currentQuestionCorrectAnswer,...e]}calcHelpAnswerPercent(e){const t=this.getAllAnswers();return u(100-e,t.length-1)}askAudience(){if(this.isHelpAudienceUsed)return;let r=[];let a=0;switch(this.difficulty){case e:a=d(65,75);break;case t:a=d(60,70);break;case s:a=d(45,55);break;case n:a=d(30,40);break;case i:a=d(20,30);break;default:a=d(1,99)}r=this.calcHelpAnswerPercent(a);const o=[a,...r];return this.isHelpAudienceUsed=!0,o}callFriend(){this.isHelpCallUsed||(_.openModal([`Your friend thinks the correct answer is '${this.currentQuestionCorrectAnswer}'`]),this.isHelpCallUsed=!0)}setNewDifficulty(e,t,s){const n=e-t;return 11===n||8===n||5===n||2===n?s+200:s}useHelp(e){const t=e.target.closest(".help__btn");if(t){if("call"===t.dataset.option&&this.callFriend(),"audience"===t.dataset.option){const[e,...t]=this.askAudience();_.displayAudienceHelp([e,...t])}if("fifty"===t.dataset.option){const e=this.removeTwoWrongAnswers();_.hideTwoWrongAnswers(e)}_.disableBtn(t)}}playerAnswer(e){const t=e.target.closest(".answer__btn");if(!t)return;if(t.classList.contains("btn--disabled")&&t.disabled)return;const s=t.children[0].innerText;this.checkAnswer(s)}}_.play_btn.addEventListener("click",g.startTheGame),_.help_btn_container.addEventListener("click",(e=>{h.useHelp(e)})),_.answers_btn_container.addEventListener("click",(e=>{h.playerAnswer(e)})),_.sidebar_btn.addEventListener("click",_.toggleSidebar.bind(_)),document.addEventListener("keydown",(function(e){"Escape"===e.key&&_.closeModal()})),_.modal_close_btn.addEventListener("click",_.closeModal.bind(_)),_.overlay.addEventListener("click",_.closeModal.bind(_));
//# sourceMappingURL=index.423d88c3.js.map
