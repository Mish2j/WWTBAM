const e="easy",t="medium",s="hard",n=e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},i=(e,t,s)=>{const n=(e=>e[Math.floor(Math.random()*e.length)])(e);for(;t.length!==s;)t.includes(n)?i(e,t,s):t.push(n)},r=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,o=(e,t)=>{let s=e,n=[];if(1===t)return n.push(s),n;for(;0!==s;){let e=r(1,s);n.push(e),s-=e}if(0===s&&n.length>t)return o(e,t);if(0===s&&n.length<t){const e=new Array(t-n.length).fill(0);return[...n,...e]}return n},a=e=>(new DOMParser).parseFromString("<!doctype html><body>"+e,"text/html").body.textContent;!function(){let c={};class l{static async startTheGame(){d.toggleGameUi(),c=new u;const e=await c.generateQuestion();d.displayQuestion(e)}static endTheGame(){d.toggleGameUi(),d.initUI(),c={}}}class d{static play_btn=document.querySelector(".startingPos__btn");static#e=document.querySelector(".game");static#t=document.querySelector(".startingPos");static#s=document.querySelectorAll(".answer__text");static#n=document.querySelector(".question__text");static help_btn_container=document.querySelector(".help__container");static answers_btn_container=document.querySelector(".answer__container");static sidebar_btn=document.querySelector(".sidebar__btn");static#i=document.querySelectorAll(".prize__li");static overlay=document.querySelector(".overlay");static#r=document.querySelector(".modal");static modal_close_btn=document.querySelector(".modal__close");static#o=document.querySelector(".modal__text");static#a=document.querySelector(".loader");static initUI(){this.#i.forEach((e=>{e.classList.contains("prize__current")&&e.classList.remove("prize__current")}));[...this.help_btn_container.querySelectorAll("button"),...this.answers_btn_container.querySelectorAll("button")].forEach((e=>{(e.classList.contains("btn--disabled")||e.disabled)&&this.activateBtn(e)})),[this.#n,...this.#s].forEach((e=>e.innerText="")),this.sidebar_btn.closest("aside").classList.contains("slide")&&this.toggleSidebar()}static toggleLoader(){this.#a.classList.toggle("hidden")}static toggleSidebar(){const e=this.sidebar_btn,t=e.closest("aside");e.children[0].classList.toggle("rotate"),t.classList.toggle("slide")}static closeModal(){this.#r.classList.add("hidden"),this.overlay.classList.add("hidden"),this.#o.innerHTML=""}static openModal(e=[]){e.forEach((e=>{const t=document.createElement("p"),s=document.createTextNode(e);t.appendChild(s),this.#o.insertAdjacentElement("beforeend",t)})),this.#r.classList.remove("hidden"),this.overlay.classList.remove("hidden")}static selectPrize(){const e=15-c.currentQuestion,t=e+1;this.#i[t]&&this.#i[t].classList.remove("prize__current"),this.#i[e].classList.add("prize__current")}static disableBtn(e){e.disabled=!0,e.classList.add("btn--disabled")}static activateBtn(e){e.disabled=!1,e.classList.remove("btn--disabled")}static toggleGameUi(){this.#t.classList.toggle("hidden"),this.#e.classList.toggle("hidden"),this.sidebar_btn.closest("aside").classList.toggle("hidden")}static displayQuestion(e){this.#n.innerText=e;const t=n(c.getAllAnswers());this.#s.forEach(((e,s)=>{e.innerText=t[s]}))}static hideTwoWrongAnswers(e){this.#s.forEach((t=>{e.includes(t.innerText)&&this.disableBtn(t.parentElement)}))}static displayAudienceHelp(e){const[t,...s]=e,i=c.getAllAnswers().filter((e=>e!==c.currentQuestionCorrectAnswer)),r=`${t}% of audience voted for '${c.currentQuestionCorrectAnswer}'`,o=s.map(((e,t)=>`${e}% of audience voted for '${i[t]}'`)),a=n([r,...o]);this.openModal(a)}}class u{currentQuestionCorrectAnswer="";currentQuestion=0;#c=[];#l=e;#d=!1;#u=!1;#h=!1;#_=[];async#w(){try{const e=await(async e=>{try{const t=await fetch(e),s=await t.json();if(!t.ok)throw new Error(`Error: ${s.message} (${t.status})`);return s}catch(e){throw e}})("https://opentdb.com/api.php?amount=1&type=multiple&difficulty="+this.#l);if(0===e.results.length)throw new Error("Failed to upload new question!");const t=e.results[0],{question:s,correct_answer:n,incorrect_answers:i}=t,r=a(s),o=a(n),c=i.map((e=>a(e)));return this.#_.includes(r)?this.#w():(this.#_.push(r),this.currentQuestionCorrectAnswer=o,this.#c=c,{decodedQuestion:r,decodedAnswer:o,decodedIncorrectAnswers:c})}catch(e){throw e}}async generateQuestion(){d.toggleLoader();try{this.currentQuestion++,this.#l=this.#p(15,this.currentQuestion,this.#l);const{decodedQuestion:e}=await this.#w();return e}catch(e){d.openModal(["Something went wrong!",e.message])}finally{d.toggleLoader()}}async#g(e){if(e!==this.currentQuestionCorrectAnswer)return d.openModal(["Wrong answer. You've lost the game!"]),void l.endTheGame();if(this.currentQuestion<15){d.selectPrize();const e=await this.generateQuestion();return d.answers_btn_container.querySelectorAll("button").forEach((e=>{e.classList.contains("btn--disabled")&&d.activateBtn(e)})),void d.displayQuestion(e)}return 15===this.currentQuestion?(d.selectPrize(),d.openModal(["You've won a million dollars!"]),void l.endTheGame()):void 0}#m(){if(this.#h)return;const e=[];i(this.#c,e,2);const t=this.#c.filter((t=>e.every((e=>t!==e))));return this.#c=t,this.#h=!0,e}getAllAnswers(){return[this.currentQuestionCorrectAnswer,...this.#c]}#f(e){const t=this.getAllAnswers();return o(100-e,t.length-1)}#y(){if(this.#u)return;let n=[];let i=0;switch(this.#l){case e:i=r(55,70);break;case t:i=r(40,55);break;case s:i=r(25,40);break;default:i=r(1,99)}n=this.#f(i);const o=[i,...n];return this.#u=!0,o}#b(){this.#d||(d.openModal([`Your friend thinks the correct answer is '${this.currentQuestionCorrectAnswer}'`]),this.#d=!0)}#p(e,n,i){const r=e-n;return 10===r&&(i=t),5===r&&(i=s),i}useHelp(e){const t=e.target.closest(".help__btn");if(t){if("call"===t.dataset.option&&this.#b(),"audience"===t.dataset.option){const[e,...t]=this.#y();d.displayAudienceHelp([e,...t])}if("fifty"===t.dataset.option){const e=this.#m();d.hideTwoWrongAnswers(e)}d.disableBtn(t)}}playerAnswer(e){const t=e.target.closest(".answer__btn");if(!t)return;if(t.classList.contains("btn--disabled")&&t.disabled)return;const s=t.children[1].innerText;this.#g(s)}}d.play_btn.addEventListener("click",l.startTheGame),d.help_btn_container.addEventListener("click",(e=>{c.useHelp(e)})),d.answers_btn_container.addEventListener("click",(e=>{c.playerAnswer(e)})),d.sidebar_btn.addEventListener("click",d.toggleSidebar.bind(d)),document.addEventListener("keydown",(function(e){"Escape"===e.key&&d.closeModal()})),d.modal_close_btn.addEventListener("click",d.closeModal.bind(d)),d.overlay.addEventListener("click",d.closeModal.bind(d))}();
//# sourceMappingURL=index.26731f9d.js.map
